#VRML V2.0 utf8



##---------------------
## Terreno
##---------------------
Shape {
	appearance Appearance {
		material Material { diffuseColor 0 1 0 }
		texture ImageTexture { 
			url "res/texturas/grass.jpg" 
		}
	}
	geometry ElevationGrid {
		xDimension 30
    	xSpacing 1
    	zDimension 20
    	zSpacing 1
    	height [
        	3.0, 2.8, 2.5, 2.3, 2.0, 1.8, 1.4, 1.0, 0.7, 0.5, 0.5, 0.5, 0.7, 0.9, 0.8, 0.7, 0.5, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        	3.1, 2.7, 2.5, 2.1, 2.0, 1.9, 1.7, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6, 1.4, 0.9, 0.6, 0.5, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        	2.8, 2.6, 2.2, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.2, 2.3, 2.0, 1.5, 1.2, 0.9, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        	2.6, 2.4, 2.1, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.2, 2.3, 2.1, 1.6, 1.4, 1.0, 0.5, 0.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        	2.5, 2.2, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.1, 2.3, 2.0, 1.7, 1.5, 1.2, 0.6, 0.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        	2.3, 2.1, 1.8, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.1, 2.2, 1.7, 1.3, 1.1, 0.7, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        	2.0, 2.0, 1.5, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 1.5, 1.0, 0.7, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        	1.7, 1.5, 1.4, 1.8, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 1.8, 1.5, 1.0, 0.7, 0.4, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        	1.1, 0.9, 1.1, 1.5, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 2.0, 1.9, 1.8, 1.5, 1.3, 1.0, 0.7, 0.3, 0.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,-0.1,-0.3,-0.2, 0.0, 0.0,
        	0.8, 0.7, 0.9, 1.2, 2.0, 2.0, 2.0, 1.8, 1.7, 1.6, 1.5, 1.4, 1.3, 1.2, 1.0, 1.0, 0.8, 0.3, 0.0, 0.0, 0.0, 0.0, 0.0,-0.1,-0.4,-0.5,-0.6,-0.3, 0.0, 0.0,
        	0.4, 0.5, 0.8, 1.2, 2.0, 2.0, 2.0, 1.8, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 0.5, 0.8, 0.8, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0,-0.4,-0.7,-0.9,-0.8,-0.5, 0.0, 0.0,
        	0.0, 0.5, 0.7, 1.0, 1.6, 1.6, 1.5, 1.5, 1.5, 0.5, 0.5, 0.8, 0.9, 0.7, 0.7, 0.5, 0.5, 0.0, 0.0,-0.2,-0.5,-0.3,-0.4,-0.7,-1.0,-1.0,-0.8,-0.2, 0.0, 0.0,
        	0.0, 0.5, 0.7, 1.0, 1.4, 1.3, 1.3, 1.4, 0.9, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0,-0.3,-0.5,-0.7,-0.6,-0.8,-1.0,-1.0,-1.0,-0.6,-0.2, 0.0, 0.0,
        	0.0, 0.4, 0.6, 0.9, 0.8, 0.8, 1.1, 1.2, 0.0, 0.0, 0.0, 0.0, 0.2, 0.5, 0.5, 0.5, 0.3, 0.0,-0.5,-1.0,-1.2,-1.2,-1.2,-1.0,-1.0,-1.0,-0.4,-0.3, 0.0, 0.0,
        	0.0, 0.3, 0.5, 0.8, 0.6, 0.5, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3, 0.5, 0.3, 0.2, 0.0,-0.6,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-0.7,-0.4, 0.0, 0.0,
        	0.0, 0.2, 0.4, 0.9, 0.4, 0.3, 1.0, 0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.5, 0.1, 0.0,-0.7,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-0.7,-0.3, 0.0, 0.0,
        	0.0, 0.1, 0.3, 0.8, 0.3, 0.3, 0.8, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4, 0.2, 0.0,-0.2,-0.5,-1.0,-1.0,-1.0,-1.0,-1.0,-1.0,-0.7,-0.4, 0.0, 0.0, 0.0,
        	0.0, 0.0, 0.2, 0.7, 0.4, 0.8, 0.8, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,-0.1,-0.4,-0.6,-0.5,-0.5,-0.6,-0.5,-0.3,-0.2, 0.0, 0.0, 0.0, 0.0,
        	0.0, 0.0, 0.0, 0.8, 0.9, 0.8, 0.6, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,-0.1,-0.1,-0.2,-0.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        	0.0, 0.0, 0.0, 0.5, 0.6, 0.7, 0.6, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
    	]
    	color NULL  
    	colorPerVertex TRUE  
    	normal NULL  
    	normalPerVertex TRUE  
    	texCoord TextureCoordinate {
    		point [
	        	0 0, 0 1, 0 2, 0 3, 0 4, 0 5, 0 6, 0 7, 0 8, 0 9, 0 10, 0 11, 0 12, 0 13, 0 14, 0 15, 0 16, 0 17, 0 18, 0 19, 0 20, 0 21, 0 22, 0 23, 0 24, 0 25, 0 26, 0 27, 0 28, 0 29, 
				1 0, 1 1, 1 2, 1 3, 1 4, 1 5, 1 6, 1 7, 1 8, 1 9, 1 10, 1 11, 1 12, 1 13, 1 14, 1 15, 1 16, 1 17, 1 18, 1 19, 1 20, 1 21, 1 22, 1 23, 1 24, 1 25, 1 26, 1 27, 1 28, 1 29, 
				2 0, 2 1, 2 2, 2 3, 2 4, 2 5, 2 6, 2 7, 2 8, 2 9, 2 10, 2 11, 2 12, 2 13, 2 14, 2 15, 2 16, 2 17, 2 18, 2 19, 2 20, 2 21, 2 22, 2 23, 2 24, 2 25, 2 26, 2 27, 2 28, 2 29, 
				3 0, 3 1, 3 2, 3 3, 3 4, 3 5, 3 6, 3 7, 3 8, 3 9, 3 10, 3 11, 3 12, 3 13, 3 14, 3 15, 3 16, 3 17, 3 18, 3 19, 3 20, 3 21, 3 22, 3 23, 3 24, 3 25, 3 26, 3 27, 3 28, 3 29, 
				4 0, 4 1, 4 2, 4 3, 4 4, 4 5, 4 6, 4 7, 4 8, 4 9, 4 10, 4 11, 4 12, 4 13, 4 14, 4 15, 4 16, 4 17, 4 18, 4 19, 4 20, 4 21, 4 22, 4 23, 4 24, 4 25, 4 26, 4 27, 4 28, 4 29, 
				5 0, 5 1, 5 2, 5 3, 5 4, 5 5, 5 6, 5 7, 5 8, 5 9, 5 10, 5 11, 5 12, 5 13, 5 14, 5 15, 5 16, 5 17, 5 18, 5 19, 5 20, 5 21, 5 22, 5 23, 5 24, 5 25, 5 26, 5 27, 5 28, 5 29, 
				6 0, 6 1, 6 2, 6 3, 6 4, 6 5, 6 6, 6 7, 6 8, 6 9, 6 10, 6 11, 6 12, 6 13, 6 14, 6 15, 6 16, 6 17, 6 18, 6 19, 6 20, 6 21, 6 22, 6 23, 6 24, 6 25, 6 26, 6 27, 6 28, 6 29, 
				7 0, 7 1, 7 2, 7 3, 7 4, 7 5, 7 6, 7 7, 7 8, 7 9, 7 10, 7 11, 7 12, 7 13, 7 14, 7 15, 7 16, 7 17, 7 18, 7 19, 7 20, 7 21, 7 22, 7 23, 7 24, 7 25, 7 26, 7 27, 7 28, 7 29, 
				8 0, 8 1, 8 2, 8 3, 8 4, 8 5, 8 6, 8 7, 8 8, 8 9, 8 10, 8 11, 8 12, 8 13, 8 14, 8 15, 8 16, 8 17, 8 18, 8 19, 8 20, 8 21, 8 22, 8 23, 8 24, 8 25, 8 26, 8 27, 8 28, 8 29, 
				9 0, 9 1, 9 2, 9 3, 9 4, 9 5, 9 6, 9 7, 9 8, 9 9, 9 10, 9 11, 9 12, 9 13, 9 14, 9 15, 9 16, 9 17, 9 18, 9 19, 9 20, 9 21, 9 22, 9 23, 9 24, 9 25, 9 26, 9 27, 9 28, 9 29, 
				10 0, 10 1, 10 2, 10 3, 10 4, 10 5, 10 6, 10 7, 10 8, 10 9, 10 10, 10 11, 10 12, 10 13, 10 14, 10 15, 10 16, 10 17, 10 18, 10 19, 10 20, 10 21, 10 22, 10 23, 10 24, 10 25, 10 26, 10 27, 10 28, 10 29, 
				11 0, 11 1, 11 2, 11 3, 11 4, 11 5, 11 6, 11 7, 11 8, 11 9, 11 10, 11 11, 11 12, 11 13, 11 14, 11 15, 11 16, 11 17, 11 18, 11 19, 11 20, 11 21, 11 22, 11 23, 11 24, 11 25, 11 26, 11 27, 11 28, 11 29, 
				12 0, 12 1, 12 2, 12 3, 12 4, 12 5, 12 6, 12 7, 12 8, 12 9, 12 10, 12 11, 12 12, 12 13, 12 14, 12 15, 12 16, 12 17, 12 18, 12 19, 12 20, 12 21, 12 22, 12 23, 12 24, 12 25, 12 26, 12 27, 12 28, 12 29, 
				13 0, 13 1, 13 2, 13 3, 13 4, 13 5, 13 6, 13 7, 13 8, 13 9, 13 10, 13 11, 13 12, 13 13, 13 14, 13 15, 13 16, 13 17, 13 18, 13 19, 13 20, 13 21, 13 22, 13 23, 13 24, 13 25, 13 26, 13 27, 13 28, 13 29, 
				14 0, 14 1, 14 2, 14 3, 14 4, 14 5, 14 6, 14 7, 14 8, 14 9, 14 10, 14 11, 14 12, 14 13, 14 14, 14 15, 14 16, 14 17, 14 18, 14 19, 14 20, 14 21, 14 22, 14 23, 14 24, 14 25, 14 26, 14 27, 14 28, 14 29, 
				15 0, 15 1, 15 2, 15 3, 15 4, 15 5, 15 6, 15 7, 15 8, 15 9, 15 10, 15 11, 15 12, 15 13, 15 14, 15 15, 15 16, 15 17, 15 18, 15 19, 15 20, 15 21, 15 22, 15 23, 15 24, 15 25, 15 26, 15 27, 15 28, 15 29, 
				16 0, 16 1, 16 2, 16 3, 16 4, 16 5, 16 6, 16 7, 16 8, 16 9, 16 10, 16 11, 16 12, 16 13, 16 14, 16 15, 16 16, 16 17, 16 18, 16 19, 16 20, 16 21, 16 22, 16 23, 16 24, 16 25, 16 26, 16 27, 16 28, 16 29, 
				17 0, 17 1, 17 2, 17 3, 17 4, 17 5, 17 6, 17 7, 17 8, 17 9, 17 10, 17 11, 17 12, 17 13, 17 14, 17 15, 17 16, 17 17, 17 18, 17 19, 17 20, 17 21, 17 22, 17 23, 17 24, 17 25, 17 26, 17 27, 17 28, 17 29, 
				18 0, 18 1, 18 2, 18 3, 18 4, 18 5, 18 6, 18 7, 18 8, 18 9, 18 10, 18 11, 18 12, 18 13, 18 14, 18 15, 18 16, 18 17, 18 18, 18 19, 18 20, 18 21, 18 22, 18 23, 18 24, 18 25, 18 26, 18 27, 18 28, 18 29, 
				19 0, 19 1, 19 2, 19 3, 19 4, 19 5, 19 6, 19 7, 19 8, 19 9, 19 10, 19 11, 19 12, 19 13, 19 14, 19 15, 19 16, 19 17, 19 18, 19 19, 19 20, 19 21, 19 22, 19 23, 19 24, 19 25, 19 26, 19 27, 19 28, 19 29, 
	    	]  
    	}
    	ccw TRUE  
    	solid TRUE  
    	creaseAngle 3.0 
	}
}



##---------------------
## Nubes
##---------------------
EXTERNPROTO Nube1 [ field SFVec3f translation ] "Nube.wrl#Nube1"
EXTERNPROTO Nube2 [ field SFVec3f translation ] "Nube.wrl#Nube2"

DEF GrupoNubes1 Transform {
	children [
		Transform { translation   0 0   0  children DEF Nube1 Nube1 { } }
		Transform { translation  15 0  11  children DEF Nube2 Nube2 { } }		
	]
}
DEF GrupoNubes2 Transform {
	children [
		Transform { translation -10 0  15  children USE Nube1 }
		Transform { translation   5 0 -12  children USE Nube1 }	
	]
}
DEF GrupoNubes3 Transform {
	children [
		Transform { translation  10 0  -5  children USE Nube2 }
		Transform { translation  -5 0   7  children USE Nube1 }	
	]
}
DEF GrupoNubes4 Transform {
	children [
		Transform { translation   0 0  -8  children USE Nube2 }
		Transform { translation -15 0   4  children USE Nube2 }	
	]
}

DEF	TSensor1 TimeSensor { loop TRUE  cycleInterval 40 }
DEF	TSensor2 TimeSensor { loop TRUE  cycleInterval 50 }
DEF	TSensor3 TimeSensor { loop TRUE  cycleInterval 60 }
DEF	TSensor4 TimeSensor { loop TRUE  cycleInterval 70 }


DEF	PInter1 PositionInterpolator { key [0 1]  keyValue [-30 15 10, 60 15 10] }
DEF	PInter2 PositionInterpolator { key [0 1]  keyValue [-30 15 10, 60 15 10] }
DEF	PInter3 PositionInterpolator { key [0 1]  keyValue [-30 15 10, 60 15 10] }
DEF	PInter4 PositionInterpolator { key [0 1]  keyValue [-30 15 10, 60 15 10] }

ROUTE TSensor1.fraction_changed TO PInter1.set_fraction
ROUTE PInter1.value_changed TO GrupoNubes1.translation
ROUTE TSensor2.fraction_changed TO PInter2.set_fraction
ROUTE PInter2.value_changed TO GrupoNubes2.translation
ROUTE TSensor3.fraction_changed TO PInter3.set_fraction
ROUTE PInter3.value_changed TO GrupoNubes3.translation
ROUTE TSensor4.fraction_changed TO PInter4.set_fraction
ROUTE PInter4.value_changed TO GrupoNubes4.translation



##---------------------
## Arboles
##---------------------
EXTERNPROTO Arbol1 [] "Arboles.wrl#Arbol1"
EXTERNPROTO Arbol2 [] "Arboles.wrl#Arbol2"
EXTERNPROTO Tronco1 [] "Arboles.wrl#Tronco1"
EXTERNPROTO Tronco2 [] "Arboles.wrl#Tronco2"

DEF Bosque1 Transform {
	translation 19 0 1
	children [
		Transform { translation 0.0 0.0 0.0  children Arbol1 {} }
		Transform { translation 0.8 -.1 1.6  children Arbol1 {} }
		Transform { translation 1.9 0.0 0.7  children Arbol1 {} }
		Transform { translation 3.6 -.2 2.2  children Arbol1 {} }

		Transform { translation 0.0 0.3 2.7  children Arbol2 {} }
		Transform { translation 1.1 0.0 0.3  children Arbol2 {} }
		Transform { translation 2.7 0.2 0.5  children Arbol2 {} }
		Transform { translation 2.5 0.0 2.5  children Arbol2 {} }

		Transform { translation 1.1 -.6 2.8  children Tronco1 {} }
		Transform { translation 3.5 -.2 0.4  children Tronco2 {} }
	]
}

DEF Bosque2 Transform {
	translation 3 .5 12
	children [
		Transform { translation 0.0 0.2 0.0  children Arbol1 {} }
		Transform { translation 0.2 0.0 1.3  children Arbol1 {} }
		Transform { translation -.8 -.3 2.0  children Arbol1 {} }
		Transform { translation 0.1 0.2 3.2  children Arbol1 {} }
		Transform { translation -.3 -.2 4.9  children Arbol1 {} }
		Transform { translation 1.9 0.3 0.5  children Arbol2 {} }
		Transform { translation 2.9 0.4 1.9  children Arbol2 {} }

		Transform { translation 1.4 -.1 1.3  children Tronco2 {} }
	]
}


##---------------------
## Flores
##---------------------
EXTERNPROTO Flor [
	field SFFloat altura 
	field SFColor color_centro
	field SFColor color_petalos 
	field SFRotation rotationX 
	field SFRotation rotationY 
] "Flores.wrl#Flor"

Transform {
	rotation 0 1 0 .5
	translation 9 2.15 6
	children [
		Transform{ translation 0.0 0.0 0.0  children Flor{ rotationY 0 1 0 -.3  color_petalos .3 .6 .9 } }
		Transform{ translation 0.4 0.0 0.2  children Flor{ rotationY 0 1 0 0.4  color_petalos .9 .6 .3 } }
		Transform{ translation -.2 0.0 0.4  children Flor{ rotationY 0 1 0 0.6  color_petalos .9 .9 .0 } }
		Transform{ translation 0.1 0.0 -.3  children Flor{ rotationY 0 1 0 -.1  color_petalos .9 .0 .9 } }
		Transform{ translation 0.2 0.0 0.6  children Flor{ rotationY 0 1 0 0.2  color_petalos .9 .0 .0 } }
		Transform{ translation 0.6 0.0 -.1  children Flor{ rotationY 0 1 0 0.1  color_petalos .9 .5 .0 } }
		Transform{ translation 0.8 0.0 0.3  children Flor{ rotationY 0 1 0 -.2  color_petalos .3 .9 .3 } }
		Transform{ translation 1.0 0.0 -.2  children Flor{ rotationY 0 1 0 0.3  color_petalos .3 .3 .9 } }
	]
}


##---------------------
## Grupos de flores
##---------------------
Transform { translation 10 -.1 14 rotation 0 1 0 0.0  children DEF GrupoFlores1 Inline { url "Flores.wrl" } }
Transform { translation  9 -.1 14.9 rotation 0 1 0 0.5  children DEF GrupoFlores2 Inline { url "Flores.wrl" } }

Transform { translation 27 0 2.5 rotation 0 1 0 0.0  children DEF GrupoFlores3 Inline { url "Flores.wrl" } }

#EXTERNPROTO Flor1 [ 
#	field SFColor color_petalos 
#] "Flores.wrl"

#Transform {
#	translation 11 .2 14
#	children Flor1 { color_petalos .1 .1 .1 }
#}



##---------------------
## Cabaña
##---------------------
Transform {
	rotation 0 1 0 0.4
	translation	7.5 3 4.5
	children Inline { url "CasaExterior.wrl" }
}

##---------------------
## Sonidos
##---------------------
Sound {  
    source DEF WaterSplash AudioClip { url "res/audio/Water_splash.wav" }
    intensity 0.5
    minFront 20  maxFront 100  minBack 20  maxBack 100 
}
Sound {  
    source DEF WaterWalking AudioClip { url "res/audio/Walking_in_water.wav" }
    intensity 0.5
    minFront 20  maxFront 100  minBack 20  maxBack 100 
}


##---------------------
## Lago pequeño
##---------------------
Transform {
	translation	4.5 0.1 15
	children [
		DEF PSensor ProximitySensor { size 2 10 4 }
		Shape {
			appearance Appearance {
				material Material { diffuseColor 0 1 1 }
				texture DEF TEXTURE_WATER ImageTexture { 
					url "res/texturas/water2.jpg" 
				}
			}
			geometry Box { size 2.5 1 5 }
		}
	]
}
ROUTE PSensor.enterTime TO WaterSplash.set_startTime
ROUTE PSensor.exitTime  TO WaterSplash.set_startTime


##---------------------
## Lago grande
##---------------------
Transform {
	translation	22 -0.75 12.5
	children [
		DEF PSensor2 ProximitySensor { size 12 10 11 }
		Shape {
			appearance Appearance {
				material Material { diffuseColor 0 1 1 }
				texture USE TEXTURE_WATER
			}
			geometry Box { size 13 1 12 }
		}
		Transform {
			translation .5 0 .5
			children DEF Pez1 Transform {
				rotation 0 1 0 0
				children [
					Transform {
						translation 0 .5 0
						children Inline { url "Pez.wrl" }
					}
				]		
			}
		}
		Transform {
			scale .5 1 .5
			rotation 0 1 0 1.0
			translation -2 0 2
			children DEF Pez2 Transform {
				children Transform {
					translation 0 .5 0
					children Inline { url "Pez.wrl" }
				}		
			}
		}
	]
}
ROUTE PSensor2.enterTime TO WaterWalking.set_startTime
ROUTE PSensor2.exitTime  TO WaterWalking.set_stopTime

DEF NadarSensor TimeSensor {
	enabled TRUE
	cycleInterval 100.0
	loop TRUE
	startTime 1.0
	stopTime  0.0
}

PROTO NadarScript [
	field SFFloat velocidad 0.005 
	field SFFloat distancia 0.9
	eventIn SFFloat set_fraction
	eventOut SFVec3f position_changed
	eventOut SFRotation rotation_changed
] {
	Script {
		field SFFloat delta IS velocidad		## Incremento de distancia en cada instante
		field SFFloat side IS distancia			## Lado del cuadrado recorrido
		field SFFloat cycles 1
		field SFInt32 cont 0
		field SFBool positivo TRUE
		eventOut SFInt32 cont_out
		eventIn SFFloat set_fraction IS set_fraction
		eventOut SFVec3f position_changed IS position_changed
		eventOut SFRotation rotation_changed IS rotation_changed
		url "javascript:
			function set_fraction( f, tm ) {
	//			position_changed[0] = Math.sin( ((f*360)*cycles*10)/180.0 * 3.1415927 );
	//			position_changed[1] = 0;
	//			position_changed[2] = Math.cos( ((f*360)*cycles*10)/180.0 * 3.1415927 ); 

				//Recorrido aleatorio en un area de 2x2
				var x = position_changed[0];
				var z = position_changed[2];
				var rot = rotation_changed[3];
	//			cont +=1;
	//			var dist = Math.floor(Math.random()*100) + 100;

	//			if(cont%dist == 0){
	//				var derizq = Math.floor(Math.random(2)*10);
	//				if(derizq % 2 == 0)
	//					rot += 1.57;
	//				else
	//					rot -= 1.57;

	//				if(rot > 4.75) rot = 0.0;
	//				else if(rot < 0) rot = 4.71;
	//				rotation_changed[3] = rot;
	//			}
	//			rotation_changed[0] = 0;
	//			rotation_changed[1] = 1;
	//			rotation_changed[2] = 0;
	//			rotation_changed[3] = rot;


	//			if(rot<0.5 || rot>6.3){		 if(z<0.95) position_changed[2] += 0.005; }
	//			else if(rot>1.5 && rot<1.6){ if(x<0.95) position_changed[0] += 0.005; }
	//			else if(rot>3.1 && rot<3.2){ if(z>-.95) position_changed[2] -= 0.005; }
	//			else if(rot>4.6 && rot<4.8){ if(x>-.95) position_changed[0] -= 0.005; }

				//Perimetro de la zona del pez (temporal)
				if(positivo == TRUE){
					if     (x< side){ x += delta; if(rot != 0.00) rot = 0.00; }
					else if(z< side){ z += delta; if(rot != 4.71) rot = 4.71; }
				    else positivo = FALSE; 
				}
				else{
					if     (x>-side){ x -= delta; if(rot != 3.14) rot = 3.14; }
					else if(z>-side){ z -= delta; if(rot != 1.57) rot = 1.57; }
					else positivo = TRUE;
				}
				position_changed[0] = x;
				position_changed[2] = z;
				rotation_changed[0] = 0;
				rotation_changed[1] = 1;
				rotation_changed[2] = 0;
				rotation_changed[3] = rot;
			}"
	}
}
DEF NadarPez1 NadarScript { velocidad 0.007  distancia 0.8 }
DEF NadarPez2 NadarScript { velocidad 0.003  distancia 0.6 }

ROUTE NadarSensor.fraction_changed TO NadarPez1.set_fraction
ROUTE NadarPez1.position_changed TO Pez1.set_translation
ROUTE NadarPez1.rotation_changed TO Pez1.set_rotation
ROUTE NadarSensor.fraction_changed TO NadarPez2.set_fraction
ROUTE NadarPez2.position_changed TO Pez2.set_translation
ROUTE NadarPez2.rotation_changed TO Pez2.set_rotation

#ROUTE NadarSensor.fraction_changed TO Nadar.set_fraction
#ROUTE Nadar.position_changed TO Pez1.set_translation
#ROUTE Nadar.rotation_changed TO Pez1.set_rotation
#ROUTE Nadar.position_changed TO Pez2.set_translation
#ROUTE Nadar.rotation_changed TO Pez2.set_rotation


